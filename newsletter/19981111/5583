Return-Path: <itojun@turmeric.itojun.org>
Received: from orange.kame.net (orange.kame.net [203.178.141.194])
	by coconut.itojun.org (8.9.1+3.1W/3.7W) with ESMTP id XAA25521
	for <itojun@itojun.org>; Fri, 30 Oct 1998 23:51:21 +0900 (JST)
Received: from turmeric.itojun.org ([209.154.161.150])
	by orange.kame.net (8.9.1+3.1W/3.7W/smtpfeed 0.89) with ESMTP id XAA00587
	for <core@kame.net>; Fri, 30 Oct 1998 23:51:18 +0900 (JST)
Received: from localhost (localhost [127.0.0.1])
	by turmeric.itojun.org (8.8.5/3.7W) with ESMTP id XAA00633;
	Fri, 30 Oct 1998 23:50:39 +0900 (JST)
To: core@kame.net
Subject: play with racoon
X-Template-Reply-To: itojun@itojun.org
X-Template-Return-Receipt-To: itojun@itojun.org
X-PGP-Fingerprint: F8 24 B4 2C 8C 98 57 FD  90 5F B4 60 79 54 16 E2
cc: itojun@itojun.org
From: Jun-ichiro itojun Itoh <itojun@iijlab.net>
X-Mailer: comp (MHng project) version 1998/02/23 14:27:23, by Jun-ichiro Itoh
MIME-Version: 1.0
Content-type: text/plain; charset=iso-2022-jp
Content-transfer-encoding: 7bit
Content-ID: <top.909759039.626@turmeric.itojun.org>
Date: Fri, 30 Oct 1998 23:50:39 +0900
Message-ID: <631.909759039@turmeric.itojun.org>
Sender: itojun@turmeric.itojun.org
X-Filter: mailagent [version 3.0 PL56] for itojun@itojun.org

	たのしいracoonのあそびかた

	両方のホストで:
	1. カーネル、userlandとも最新にする
	2. kit/src/racoonで
		% ./configure
		% make
		# make install
	3. 以下のsysctl MIBを設定
		sysctl -w net.inet.ipsec.def_policy=2
		sysctl -w net.inet.ipsec.esp_trans_deflev=3
		sysctl -w net.inet.ipsec.ah_trans_deflev=3
	4. racoon起動
		# racoon -f ibm.conf			(daemon)
		# racoon -f ibm.conf -d 0xffffffff	(debug mode, foreground)
	   註: racoonはsignalをいっこでも受けると死んでしまうので、ctrl-Zで
	   backgroundにまわしたりはできません。
	   (これ変えません? >sakane)

	片方のホストで:
	5. SAをつくらせる
		# ping -A machineB.kame.net	(AHだけ)
		# ping -E machineB.kame.net	(ESPだけ)
		# ping -EA machineB.kame.net	(ESP/AH両方欲しいとき)
	6. しばらく待つとSAが設定される(はず)。
	   racoonをdebug modeであげてる場合わかりやすい。
		# setkey -D
	7. telnet machineB.kame.netとかやるとひねって出て行く
		ポリシ設定が3(IFAVAIL)なので、「SAがあれば使う」
	8. SAの寿命がきたときに通信していると、ちょっと刺さるかもしれないけど、
	   自動更新されるはず

	えんじょい。

itojun
